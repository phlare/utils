<!DOCTYPE html>
<html>
<head>
	<script type="text/javascript" src="../simpleQueue.js"></script>
	<script type="text/javascript" src="../queue.js"></script>
	<title>Queue</title>
	<style type="text/css">
		.two-col {
			background-color: #eeeeee;
			float:left;
			width:46%;
			margin: 4px 1%;
			height: 300px;
			overflow-y: scroll;
			padding: 4px 1%;
		}
		.bench_head {
			float: left;
			margin: 0 4px;
			width: 100px;
			font-weight: 800;
		}
		.bench_cell {
			float: left;
			padding: 0px;
			margin: 0 4px;
			width: 100px;
			overflow-x: hidden;
		}
		.row {
			clear:both;
		}
	</style>
</head>
<body>
	<a href="index.html">back to list</a><br />
	<p>
		queue.js loaded. check the console for output.
	</p>
	<p></p>
	Display:<br/>
	<div id="displayQueues">
		<div class="two-col">
			<h3>using builtin push() and shift()</h3>
			<pre id="displayArea1"><pre>
		</div>
		<div class="two-col">
			<h3>customized queue</h3>
			<pre id="displayArea2"><pre>
		</div>
	</div>
	<div id="benchmarks"></div>

	<script type="text/javascript">
		var queueTest = {
			sq: null,
			q: null,
			benchmarks: [],
			init: function() {

				console.log('initializing objects...');
				this.q = new Queue();
				this.sq = new SimpleQueue();

				this.display();
				this.runBenchmarks(10, 400000, 1.5);

			},
			display: function() {
				this.sq.display('text', 'displayArea1');
				this.q.display('text','displayArea2');
			},
			runBenchmarks: function(min_n, max_n, scale) {
				min_n = min_n || 100;
				max_n = max_n || 100000;
				scale = scale || 1.5;
				for (var i = min_n; i <= max_n; i *= scale) {
					this.benchmarks.push(this.benchmark(i));
				}
				this.printBenchmark();
			},
			benchmark: function(n) {

				var start = 0;
				var stop = 0;

				var benchData = {
					'n' : parseInt(n, 10),
					'pushes' : {
						'sq' : 0,
						'q' : 0
					},
					'shifts' : {
						'sq' : 0,
						'q' : 0
					}
				};

				console.log('pushing ' + n + ' to SimpleQueue');
				start = performance.now();
				this.multiplePushes(this.sq, n);
				stop = performance.now();
				benchData.pushes.sq = (stop - start);

				console.log('pushing ' + n + ' to Queue');
				start = performance.now();
				this.multiplePushes(this.q, n);
				stop = performance.now();
				benchData.pushes.q = (stop - start);

				console.log('shifting ' + n + ' from SimpleQueue');
				start = performance.now();
				this.multipleShifts(this.sq, n);
				stop = performance.now();
				benchData.shifts.sq = (stop - start);

				console.log('shifting ' + n + ' from Queue');
				start = performance.now();
				this.multipleShifts(this.q, n);
				stop = performance.now();
				benchData.shifts.q = (stop - start);

				return benchData;

			},
			printBenchmark: function() {
				var bmContainer = document.getElementById('benchmarks');
				out = 'Benchmark:<br/>';
				if (this.benchmarks.length === 0) {
					out += 'no benchmarks';
				} else {
					out += '<div class="row">';
					out += '    <div class="bench_head">n</div>';
					out += '    <div class="bench_head">sq push</div>';
					out += '    <div class="bench_head">q push</div>';
					out += '    <div class="bench_head">sq shift</div>';
					out += '    <div class="bench_head">q shift</div>';
					out += '</div>'

					for (var i = 0; i < this.benchmarks.length; i++) {
						out += '<div class="row">';
						out += '    <div class="bench_cell">' + this.benchmarks[i]['n'] + '</div>';
						out += '    <div class="bench_cell">' + (Math.round(this.benchmarks[i]['pushes']['sq'] * 1000) / 1000) + '</div>';
						out += '    <div class="bench_cell">' + (Math.round(this.benchmarks[i]['pushes']['q'] * 1000) / 1000) + '</div>';
						out += '    <div class="bench_cell">' + (Math.round(this.benchmarks[i]['shifts']['sq'] * 1000) / 1000) + '</div>';
						out += '    <div class="bench_cell">' + (Math.round(this.benchmarks[i]['shifts']['q'] * 1000) / 1000) + '</div>';
						out += '</div>';
					}
				}

				bmContainer.innerHTML = out;

			},

			multipleShifts: function(queue, n) {
				n = n || 5;
				queue = queue || this.q;
				for (var i = 0; i < n; i++) {
					var val = queue.shift();
				}
			},
			multiplePushes: function(queue, n) {
				n = n || 5;
				queue = queue || this.q;
				for (var i = 0; i < n; i++) {
					queue.push(i);
				}
			}
		};

		queueTest.init();

	</script>

</body>
</html>